\section{The immersed boundary method}\label{sec:ib}

\subsection{Overview}\label{sec:ib_old}

Consider a rectangular domain, $\domain\subset\R^3$, which contains one or more
deformable structures and is otherwise filled with an incompressible, Newtonian fluid
with constant density, $\density$, and viscosity, $\viscosity$. The IB method treats
these structures as an extension of the fluid. The motion of any particle in $\domain$ is
therefore governed by the incompressible Navier-Stokes equations,
\begin{gather}
    \density(\u_t + \div(\u\otimes\u)) = \viscosity\laplacian \u - \grad p + \f, \label{eq:ins-momentum} \\
    \div \u = 0, \label{eq:ins-incomp}
\end{gather}
where, for $\x = (x,\,y,\,z) \in \domain$, $\u = \u(\x,\,t) = (u, v, w)$ is the fluid
velocity, $p = p(\x,\,t)$ is the pressure, and $\f = \f(\x,\,t)$ is an external force
density. Here and throughout this paper, we use bold italic symbols to indicate a vector
in $\R^3$. Treating the entire domain as a fluid allows us to discretize $\domain$
independently of the immersed structures with a fixed regular grid of spacing $h$. This
is the Eulerian grid.

Let $\X = \X(\theta,\,\varphi,\,t)$, for surface coordinates $(\theta,\,\varphi)$ in
$\sites\subset\mathbb{R}^2$, be a parametrization for the immersed boundary $\interface$.
Though the interface changes with time, we suppress the time argument $t$ for brevity. A
discrete representation of the boundary, consisting of a set of surface points, replaces
its continuous counterpart.  Surface points are typically chosen to be within
approximately $h$ of their neighbors.  This is the Lagrangian grid. These boundary points
move at the local fluid velocity.  Analytically convolving the fluid velocity against the
Dirac delta function, $\Dirac(\x)$, yields the velocity of a surface point, but
discretely, Eulerian and Lagrangian grid points are unlikely to coincide. The IB method
replaces the singular Dirac delta function with a smoothed, $h$-dependent analog,
$\Dirac_h(\x)$. The Lagrangian point $\X$ evolves according to
\begin{equation}\label{eq:ib-interp}
    \vec{\dot{X}}
        = \int\limits_{\domain} \u(\x) \Dirac(\x-\X) \d\x
        \approx h^3 \sum_{i} \u(\x_i) \Dirac_h(\x_i-\X),
\end{equation}
where $i$ enumerates the Eulerian grid points, and a superposed dot denotes partial
differentiation with respect to $t$. As a boundary deforms, it generates a force density
$\F = \F(\X,\,t)$, which it imparts onto the fluid as $\f$ in~\eqref{eq:ins-momentum}.
Again, we suppress $t$ when using $\F$. By similar reasoning as the velocity, $\F$ is
transferred to the fluid at $\x$ via
\begin{equation}\label{eq:ib-spread}
        \f(\x)
        = \int\limits_{\interface} \F(\X)\Dirac(\x-\X) \d\X
        \approx \sum_{j} \weight[j]\F(\X_j) \Dirac_h(\x-\X_j),
\end{equation}
where $j$ enumerates the Lagrangian grid points, and $\weight[j]$ is the integration
weight corresponding to Lagrangian grid point $\X_j$. 

In addition to a velocity vector field, equation~\eqref{eq:ib-spread} illustrates the
need for three pieces of information for each immersed structure: the position of points
$\X_j$ used to evaluate forces on the structure; a force density $\F(\X_j)$ at each of
those points; and surface integration weights $\weight[j]$ for those points. The
structure moves according to~\eqref{eq:ib-interp}. The next three sections describe our
methods for solving~\eqref{eq:ins-momentum}--\eqref{eq:ins-incomp} (Section~%
\ref{sec:ins}), give analytic expressions for energy functionals used to derive $\F$
(Section~\ref{sec:energy} and~\ref{sec:forces}), and detail the discretization of the
structures to obtain $\X_j$, $\F(\X_j)$, and $\weight[j]$ (Section~\ref{sec:rbfs}).
However, before we do so, we discuss the specific variant of the IB method employed
herein.

\subsection{The RBF-IB method}\label{sec:rbfib}

The classical IB method uses the same the Lagrangian points in interpolation~%
\eqref{eq:ib-interp} and spreading~\eqref{eq:ib-spread}. However, there exist several IB
methods use different sets of points instead. For instance, the method in~%
\cite{Griffith:2017id} uses a finite element representation for the structure, and
consequently spreads forces from (Lagrangian) quadrature points, interpolates velocities
to quadrature points, and then projects them using the finite element basis to the
individual element nodes. The RBF-IB method introduced in~\cite{Shankar:2015km} and used
in this work also does something similar. A small set of $\data\cardinality$ Lagrangian
points approximately $2h$ apart is used to approximate $\X$ and this set of points is
moved by~\eqref{eq:ib-interp}. In addition, a larger set of $\sample\cardinality$ points
chosen to be approximately $h$ apart is used to spread forces using~\eqref{eq:ib-spread}.
While the former set is widely spaced, the spacing of the latter set of points aligns
with traditional IB implementations.

This potentially raises certain concerns, which we address here. The first major concern
relates to the force-spreading and velocity interpolation operations. In traditional IB
methods, these operators are formally adjoint, leading to conservation of energy/power~%
\cite{Peskin:2002go}. However, in the RBF-IB method, these operators are no longer
adjoint, leading to concerns about numerical stability. In previous work~%
\cite{Shankar:2015km}, the authors demonstrated that the RBF-IB method dissipated energy
in 2D simulations as expected, despite the absence of formal adjointness. In this work,
we show similar results for an RBC relaxation problem in a full 3D simulation in Section%
~\ref{sec:energy}. The second major concern related to the wide $2h$ spacing of the
smaller set of points used to approximate $\X$ and update the structure. If the points
are spaced too widely apart, it is possible to obtain unphysical behavior, with some
parts of the structure responding more to the neighboring fluid than others.  However,
both in~\cite{Shankar:2015km} and in this work, we observed that starting these points
with a spacing of $2h$ was sufficient to reproduce standard results for RBC simulations.
It may be possible to alleviate any spacing issues by periodically rearranging the points
used to approximate $\X$, but this approach was not necessary in this work, and so we
leave a full exploration of such Lagrangian rearrangement strategies for future work.
